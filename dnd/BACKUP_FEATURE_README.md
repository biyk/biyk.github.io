# Функция создания бэкапа Google таблицы

## Описание

Добавлена автоматическая функция создания бэкапа Google таблицы перед запуском тестов. Бэкап создается с датой и временем в названии для удобства идентификации.

## Основные возможности

- **Автоматическое создание бэкапа** перед запуском любых тестов
- **Именование с датой и временем** в формате: `НазваниеТаблицы_BACKUP_YYYY-MM-DDTHH-MM-SS`
- **Полное копирование** всех листов и данных из оригинальной таблицы
- **Обработка ошибок** с продолжением тестирования даже при неудачном создании бэкапа

## Использование

### Автоматический бэкап при тестировании

При запуске любых тестов (включая `test('all')`) бэкап создается автоматически:

```javascript
// Бэкап создастся автоматически
await test('all');

// Или для отдельного теста
await test('init');
```

### Ручное создание бэкапа

Можно создать бэкап вручную в любой момент:

```javascript
// Через глобальную функцию
await window.createBackup();

// Или через импорт
import {createBackup} from './tests.js';
await createBackup();
```

### Тестирование функции бэкапа

Добавлен специальный тест для проверки работы функции бэкапа:

```javascript
await test('backup');
```

## Технические детали

### Функция `createSpreadsheetBackup`

```javascript
async createSpreadsheetBackup(spreadsheetId)
```

**Параметры:**
- `spreadsheetId` - ID Google таблицы для создания бэкапа

**Возвращает:**
- `Promise<string>` - ID созданного бэкапа

**Процесс работы:**
1. Получает информацию об оригинальной таблице
2. Создает новую таблицу с названием бэкапа
3. Копирует все листы по одному
4. Заполняет каждый лист данными из оригинала

### Обработка ошибок

- При ошибке создания бэкапа тесты продолжают работать
- В консоль выводится предупреждение о неудачном бэкапе
- ID бэкапа выводится в консоль при успешном создании

## Требования

- Google API должен быть инициализирован
- Пользователь должен быть авторизован в Google
- Необходимы права на создание таблиц в Google Drive

## Примеры вывода в консоль

```
=== Создание бэкапа Google таблицы ===
Создание бэкапа: НазваниеТаблицы_BACKUP_2024-01-15T14-30-25
Бэкап создан с ID: 1ABC123DEF456GHI789JKL
Лист "Sheet1" скопирован
Лист "Sheet2" скопирован
Бэкап "НазваниеТаблицы_BACKUP_2024-01-15T14-30-25" успешно создан
✓ Бэкап создан успешно с ID: 1ABC123DEF456GHI789JKL
=== Бэкап завершен ===
```

## Безопасность

- Бэкап создается в том же Google аккаунте
- Оригинальная таблица не изменяется
- Бэкап можно удалить вручную через Google Drive при необходимости

## Устранение неполадок

### Ошибка "Google API не инициализирован"
- Убедитесь, что страница полностью загружена
- Проверьте, что Google API скрипты загружены
- Дождитесь инициализации Google API

### Ошибка авторизации
- Проверьте, что пользователь авторизован в Google
- Обновите токен авторизации при необходимости

### Ошибка создания таблицы
- Проверьте права доступа к Google Drive
- Убедитесь, что есть место для создания новых таблиц

